<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KOTALINK Status</title>
    <link rel="icon" type="image/png" href="/assets/KOTA_LOGO.png">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #000000;
            color: #ffffff;
            text-align: center;
            padding: 20px;
            position: relative;
        }
        .status-box {
            color: #000000;
            display: inline-block;
            padding: 10px 20px;
            border-radius: 8px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .status-box.green {
            background-color: #00c853;
        }
        .status-box.yellow {
            background-color: #ffeb3b;
        }
        .status-box.red {
            background-color: #f44336;
        }
        .diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .row {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px 0;
            width: 100%;
        }
        .box {
            background-color: #ff7f00;
            color: #000000;
            padding: 10px 20px;
            border-radius: 8px;
            margin: 5px 0;
            width: 90%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .box.green {
            background-color: #00c853;
        }
        .box.yellow {
            background-color: #ffeb3b;
        }
        .box.red {
            background-color: #f44336;
        }
        .status {
            margin-top: 5px;
            font-weight: bold;
        }
        @media (min-width: 768px) {
            .row {
                flex-direction: row;
                justify-content: center;
            }
            .box {
                width: auto;
                margin: 0 10px;
            }
        }
    </style>
</head>
<body>
    <h1>KOTA-LINK DIAGRAM</h1>
    <% 
        const allNodes = [status.allstar, status.echolink, status.hoip, status.p25, status.dmr, status.ysf];
        const onlineNodes = allNodes.filter(node => node === 'working');
        let overallStatus = '';
        let overallClass = '';

        if (onlineNodes.length === allNodes.length) {
            overallStatus = 'HEALTHY';
            overallClass = 'green';
        } else if (onlineNodes.length > 0) {
            overallStatus = 'TROUBLE';
            overallClass = 'yellow';
        } else {
            overallStatus = 'OFFLINE';
            overallClass = 'red';
        }
    %>
    <div class="status-box <%= overallClass %>" id="statusBox">KOTALINK OVERALL STATUS: <%= overallStatus %></div>
    <h3>KOTALINK:</h3>
    <div class="diagram">
        <div class="row">
            <div id="allstar" class="box <%= status.allstar === 'working' ? 'green' : 'red' %>">Allstar 57686<span class="status"><%= status.allstar === 'working' ? ' (working)' : ' (not working)' %></span></div>
        </div>
        <h3>Others:</h3>
        <div class="row">
            <div id="echolink1" class="box <%= status.echolink === 'working' ? 'green' : 'red' %>">N0DYG-R 910094<span class="status"><%= status.echolink %></span></div>
            <div id="echolink2" class="box <%= status.hoip === 'working' ? 'green' : 'red' %>">HOIP#15031<span class="status"><%= status.hoip === 'working' ? ' (working)' : ' (not working)' %></span></div>
        </div>
        <div class="row">
            <h3 style="color: white;">Bridges:</h3>
        </div>
        <div class="row">
            <div id="ab_mb" class="box">AB + MB<span class="status"></span></div>
            <div id="mb" class="box">MB<span class="status"></span></div>
            <div id="usrp2p25" class="box <%= status.p25 === 'working' ? 'green' : 'red' %>">USRP2P25<span class="status"><%= status.p25 === 'working' ? ' (working)' : ' (not working)' %></span></div>
        </div>
        <div class="row">
            <div id="dmr" class="box <%= status.dmr === 'working' ? 'green' : 'red' %>">DMR TGIF: 350<span class="status"><%= status.dmr === 'working' ? ' (working)' : ' (not working)' %></span></div>
            <div id="ysf" class="box <%= status.ysf === 'working' ? 'green' : 'red' %>">YSF: US-KOTA-LINK 57686<span class="status"><%= status.ysf === 'working' ? ' (working)' : ' (not working)' %></span></div>
            <div id="p25" class="box <%= status.p25 === 'working' ? 'green' : 'red' %>">P25: 65103<span class="status"><%= status.p25 === 'working' ? ' (working)' : ' (not working)' %></span></div>
        </div>
    </div>
    <p>Built By: Henry KD9YWF and Collin K0NNK</p>
    <a href="https://docs.google.com/document/d/16JPvb4zNhnY9J748p9bVcA2l1B_uru6pyRKf-L6CuEg/edit?usp=sharing">How do I read this diagram?</a>
</body>
</html>
